// File generated from our OpenAPI spec by Stainless.

package com.withorb.api.models

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.withorb.api.core.JsonValue
import com.withorb.api.core.jsonMapper
import com.withorb.api.errors.OrbInvalidDataException
import java.time.OffsetDateTime
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.assertThrows
import org.junit.jupiter.params.ParameterizedTest
import org.junit.jupiter.params.provider.EnumSource

internal class PriceTest {

    @Test
    fun ofUnit() {
        val unit =
            Price.UnitPrice.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.UnitPrice.BillingMode.IN_ADVANCE)
                .cadence(Price.UnitPrice.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.UnitPrice.CompositePriceFilter.builder()
                        .field(Price.UnitPrice.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.UnitPrice.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.UnitPrice.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.UnitPrice.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .unitConfig(UnitConfig.builder().unitAmount("unit_amount").prorated(true).build())
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofUnit(unit)

        assertThat(price.unit()).isEqualTo(unit)
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofUnitRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofUnit(
                Price.UnitPrice.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.UnitPrice.BillingMode.IN_ADVANCE)
                    .cadence(Price.UnitPrice.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.UnitPrice.CompositePriceFilter.builder()
                            .field(Price.UnitPrice.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.UnitPrice.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.UnitPrice.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.UnitPrice.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .unitConfig(
                        UnitConfig.builder().unitAmount("unit_amount").prorated(true).build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofTiered() {
        val tiered =
            Price.Tiered.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Tiered.BillingMode.IN_ADVANCE)
                .cadence(Price.Tiered.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Tiered.CompositePriceFilter.builder()
                        .field(Price.Tiered.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Tiered.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Tiered.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.Tiered.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .tieredConfig(
                    TieredConfig.builder()
                        .addTier(
                            Tier.builder()
                                .firstUnit(0.0)
                                .unitAmount("unit_amount")
                                .lastUnit(0.0)
                                .build()
                        )
                        .prorated(true)
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofTiered(tiered)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isEqualTo(tiered)
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofTieredRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofTiered(
                Price.Tiered.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Tiered.BillingMode.IN_ADVANCE)
                    .cadence(Price.Tiered.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Tiered.CompositePriceFilter.builder()
                            .field(Price.Tiered.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Tiered.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Tiered.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.Tiered.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .tieredConfig(
                        TieredConfig.builder()
                            .addTier(
                                Tier.builder()
                                    .firstUnit(0.0)
                                    .unitAmount("unit_amount")
                                    .lastUnit(0.0)
                                    .build()
                            )
                            .prorated(true)
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofBulk() {
        val bulk =
            Price.Bulk.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Bulk.BillingMode.IN_ADVANCE)
                .bulkConfig(
                    BulkConfig.builder()
                        .addTier(
                            BulkTier.builder().unitAmount("unit_amount").maximumUnits(0.0).build()
                        )
                        .build()
                )
                .cadence(Price.Bulk.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Bulk.CompositePriceFilter.builder()
                        .field(Price.Bulk.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Bulk.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Bulk.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.Bulk.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofBulk(bulk)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isEqualTo(bulk)
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofBulkRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofBulk(
                Price.Bulk.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Bulk.BillingMode.IN_ADVANCE)
                    .bulkConfig(
                        BulkConfig.builder()
                            .addTier(
                                BulkTier.builder()
                                    .unitAmount("unit_amount")
                                    .maximumUnits(0.0)
                                    .build()
                            )
                            .build()
                    )
                    .cadence(Price.Bulk.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Bulk.CompositePriceFilter.builder()
                            .field(Price.Bulk.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Bulk.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Bulk.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.Bulk.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofBulkWithFilters() {
        val bulkWithFilters =
            Price.BulkWithFilters.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.BulkWithFilters.BillingMode.IN_ADVANCE)
                .bulkWithFiltersConfig(
                    Price.BulkWithFilters.BulkWithFiltersConfig.builder()
                        .addFilter(
                            Price.BulkWithFilters.BulkWithFiltersConfig.Filter.builder()
                                .propertyKey("x")
                                .propertyValue("x")
                                .build()
                        )
                        .addTier(
                            Price.BulkWithFilters.BulkWithFiltersConfig.Tier.builder()
                                .unitAmount("unit_amount")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .addTier(
                            Price.BulkWithFilters.BulkWithFiltersConfig.Tier.builder()
                                .unitAmount("unit_amount")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .build()
                )
                .cadence(Price.BulkWithFilters.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.BulkWithFilters.CompositePriceFilter.builder()
                        .field(Price.BulkWithFilters.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.BulkWithFilters.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.BulkWithFilters.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.BulkWithFilters.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofBulkWithFilters(bulkWithFilters)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isEqualTo(bulkWithFilters)
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofBulkWithFiltersRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofBulkWithFilters(
                Price.BulkWithFilters.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.BulkWithFilters.BillingMode.IN_ADVANCE)
                    .bulkWithFiltersConfig(
                        Price.BulkWithFilters.BulkWithFiltersConfig.builder()
                            .addFilter(
                                Price.BulkWithFilters.BulkWithFiltersConfig.Filter.builder()
                                    .propertyKey("x")
                                    .propertyValue("x")
                                    .build()
                            )
                            .addTier(
                                Price.BulkWithFilters.BulkWithFiltersConfig.Tier.builder()
                                    .unitAmount("unit_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .addTier(
                                Price.BulkWithFilters.BulkWithFiltersConfig.Tier.builder()
                                    .unitAmount("unit_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .build()
                    )
                    .cadence(Price.BulkWithFilters.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.BulkWithFilters.CompositePriceFilter.builder()
                            .field(Price.BulkWithFilters.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.BulkWithFilters.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.BulkWithFilters.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.BulkWithFilters.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofPackage() {
        val package_ =
            Price.Package.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Package.BillingMode.IN_ADVANCE)
                .cadence(Price.Package.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Package.CompositePriceFilter.builder()
                        .field(Price.Package.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Package.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Package.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .packageConfig(
                    PackageConfig.builder().packageAmount("package_amount").packageSize(1L).build()
                )
                .planPhaseOrder(0L)
                .priceType(Price.Package.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofPackage(package_)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isEqualTo(package_)
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofPackageRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofPackage(
                Price.Package.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Package.BillingMode.IN_ADVANCE)
                    .cadence(Price.Package.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Package.CompositePriceFilter.builder()
                            .field(Price.Package.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Package.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Package.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .packageConfig(
                        PackageConfig.builder()
                            .packageAmount("package_amount")
                            .packageSize(1L)
                            .build()
                    )
                    .planPhaseOrder(0L)
                    .priceType(Price.Package.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMatrix() {
        val matrix =
            Price.Matrix.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Matrix.BillingMode.IN_ADVANCE)
                .cadence(Price.Matrix.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Matrix.CompositePriceFilter.builder()
                        .field(Price.Matrix.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Matrix.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .matrixConfig(
                    MatrixConfig.builder()
                        .defaultUnitAmount("default_unit_amount")
                        .addDimension("string")
                        .addMatrixValue(
                            MatrixValue.builder()
                                .addDimensionValue("string")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Matrix.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.Matrix.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMatrix(matrix)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isEqualTo(matrix)
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMatrixRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMatrix(
                Price.Matrix.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Matrix.BillingMode.IN_ADVANCE)
                    .cadence(Price.Matrix.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Matrix.CompositePriceFilter.builder()
                            .field(Price.Matrix.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Matrix.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .matrixConfig(
                        MatrixConfig.builder()
                            .defaultUnitAmount("default_unit_amount")
                            .addDimension("string")
                            .addMatrixValue(
                                MatrixValue.builder()
                                    .addDimensionValue("string")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Matrix.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.Matrix.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofThresholdTotalAmount() {
        val thresholdTotalAmount =
            Price.ThresholdTotalAmount.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.ThresholdTotalAmount.BillingMode.IN_ADVANCE)
                .cadence(Price.ThresholdTotalAmount.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.ThresholdTotalAmount.CompositePriceFilter.builder()
                        .field(Price.ThresholdTotalAmount.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.ThresholdTotalAmount.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.ThresholdTotalAmount.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.ThresholdTotalAmount.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .thresholdTotalAmountConfig(
                    Price.ThresholdTotalAmount.ThresholdTotalAmountConfig.builder()
                        .addConsumptionTable(
                            Price.ThresholdTotalAmount.ThresholdTotalAmountConfig.ConsumptionTable
                                .builder()
                                .threshold("threshold")
                                .totalAmount("total_amount")
                                .build()
                        )
                        .addConsumptionTable(
                            Price.ThresholdTotalAmount.ThresholdTotalAmountConfig.ConsumptionTable
                                .builder()
                                .threshold("threshold")
                                .totalAmount("total_amount")
                                .build()
                        )
                        .prorate(true)
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofThresholdTotalAmount(thresholdTotalAmount)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isEqualTo(thresholdTotalAmount)
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofThresholdTotalAmountRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofThresholdTotalAmount(
                Price.ThresholdTotalAmount.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.ThresholdTotalAmount.BillingMode.IN_ADVANCE)
                    .cadence(Price.ThresholdTotalAmount.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.ThresholdTotalAmount.CompositePriceFilter.builder()
                            .field(Price.ThresholdTotalAmount.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.ThresholdTotalAmount.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.ThresholdTotalAmount.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.ThresholdTotalAmount.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .thresholdTotalAmountConfig(
                        Price.ThresholdTotalAmount.ThresholdTotalAmountConfig.builder()
                            .addConsumptionTable(
                                Price.ThresholdTotalAmount.ThresholdTotalAmountConfig
                                    .ConsumptionTable
                                    .builder()
                                    .threshold("threshold")
                                    .totalAmount("total_amount")
                                    .build()
                            )
                            .addConsumptionTable(
                                Price.ThresholdTotalAmount.ThresholdTotalAmountConfig
                                    .ConsumptionTable
                                    .builder()
                                    .threshold("threshold")
                                    .totalAmount("total_amount")
                                    .build()
                            )
                            .prorate(true)
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofTieredPackage() {
        val tieredPackage =
            Price.TieredPackage.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.TieredPackage.BillingMode.IN_ADVANCE)
                .cadence(Price.TieredPackage.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.TieredPackage.CompositePriceFilter.builder()
                        .field(Price.TieredPackage.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.TieredPackage.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.TieredPackage.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.TieredPackage.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .tieredPackageConfig(
                    Price.TieredPackage.TieredPackageConfig.builder()
                        .packageSize("package_size")
                        .addTier(
                            Price.TieredPackage.TieredPackageConfig.Tier.builder()
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .addTier(
                            Price.TieredPackage.TieredPackageConfig.Tier.builder()
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofTieredPackage(tieredPackage)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isEqualTo(tieredPackage)
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofTieredPackageRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofTieredPackage(
                Price.TieredPackage.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.TieredPackage.BillingMode.IN_ADVANCE)
                    .cadence(Price.TieredPackage.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.TieredPackage.CompositePriceFilter.builder()
                            .field(Price.TieredPackage.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.TieredPackage.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.TieredPackage.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.TieredPackage.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .tieredPackageConfig(
                        Price.TieredPackage.TieredPackageConfig.builder()
                            .packageSize("package_size")
                            .addTier(
                                Price.TieredPackage.TieredPackageConfig.Tier.builder()
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .addTier(
                                Price.TieredPackage.TieredPackageConfig.Tier.builder()
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofTieredWithMinimum() {
        val tieredWithMinimum =
            Price.TieredWithMinimum.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.TieredWithMinimum.BillingMode.IN_ADVANCE)
                .cadence(Price.TieredWithMinimum.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.TieredWithMinimum.CompositePriceFilter.builder()
                        .field(Price.TieredWithMinimum.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.TieredWithMinimum.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.TieredWithMinimum.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.TieredWithMinimum.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .tieredWithMinimumConfig(
                    Price.TieredWithMinimum.TieredWithMinimumConfig.builder()
                        .addTier(
                            Price.TieredWithMinimum.TieredWithMinimumConfig.Tier.builder()
                                .minimumAmount("minimum_amount")
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .addTier(
                            Price.TieredWithMinimum.TieredWithMinimumConfig.Tier.builder()
                                .minimumAmount("minimum_amount")
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .hideZeroAmountTiers(true)
                        .prorate(true)
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofTieredWithMinimum(tieredWithMinimum)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isEqualTo(tieredWithMinimum)
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofTieredWithMinimumRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofTieredWithMinimum(
                Price.TieredWithMinimum.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.TieredWithMinimum.BillingMode.IN_ADVANCE)
                    .cadence(Price.TieredWithMinimum.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.TieredWithMinimum.CompositePriceFilter.builder()
                            .field(Price.TieredWithMinimum.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.TieredWithMinimum.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.TieredWithMinimum.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.TieredWithMinimum.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .tieredWithMinimumConfig(
                        Price.TieredWithMinimum.TieredWithMinimumConfig.builder()
                            .addTier(
                                Price.TieredWithMinimum.TieredWithMinimumConfig.Tier.builder()
                                    .minimumAmount("minimum_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .addTier(
                                Price.TieredWithMinimum.TieredWithMinimumConfig.Tier.builder()
                                    .minimumAmount("minimum_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .hideZeroAmountTiers(true)
                            .prorate(true)
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedTiered() {
        val groupedTiered =
            Price.GroupedTiered.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedTiered.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedTiered.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedTiered.CompositePriceFilter.builder()
                        .field(Price.GroupedTiered.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.GroupedTiered.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedTieredConfig(
                    Price.GroupedTiered.GroupedTieredConfig.builder()
                        .groupingKey("x")
                        .addTier(
                            Price.GroupedTiered.GroupedTieredConfig.Tier.builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .addTier(
                            Price.GroupedTiered.GroupedTieredConfig.Tier.builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedTiered.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedTiered.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedTiered(groupedTiered)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isEqualTo(groupedTiered)
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedTieredRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedTiered(
                Price.GroupedTiered.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedTiered.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedTiered.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedTiered.CompositePriceFilter.builder()
                            .field(Price.GroupedTiered.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.GroupedTiered.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedTieredConfig(
                        Price.GroupedTiered.GroupedTieredConfig.builder()
                            .groupingKey("x")
                            .addTier(
                                Price.GroupedTiered.GroupedTieredConfig.Tier.builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .addTier(
                                Price.GroupedTiered.GroupedTieredConfig.Tier.builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedTiered.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedTiered.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofTieredPackageWithMinimum() {
        val tieredPackageWithMinimum =
            Price.TieredPackageWithMinimum.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.TieredPackageWithMinimum.BillingMode.IN_ADVANCE)
                .cadence(Price.TieredPackageWithMinimum.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.TieredPackageWithMinimum.CompositePriceFilter.builder()
                        .field(Price.TieredPackageWithMinimum.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.TieredPackageWithMinimum.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.TieredPackageWithMinimum.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.TieredPackageWithMinimum.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .tieredPackageWithMinimumConfig(
                    Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.builder()
                        .packageSize(0.0)
                        .addTier(
                            Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.Tier
                                .builder()
                                .minimumAmount("minimum_amount")
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .addTier(
                            Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.Tier
                                .builder()
                                .minimumAmount("minimum_amount")
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofTieredPackageWithMinimum(tieredPackageWithMinimum)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isEqualTo(tieredPackageWithMinimum)
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofTieredPackageWithMinimumRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofTieredPackageWithMinimum(
                Price.TieredPackageWithMinimum.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.TieredPackageWithMinimum.BillingMode.IN_ADVANCE)
                    .cadence(Price.TieredPackageWithMinimum.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.TieredPackageWithMinimum.CompositePriceFilter.builder()
                            .field(
                                Price.TieredPackageWithMinimum.CompositePriceFilter.Field.PRICE_ID
                            )
                            .operator(
                                Price.TieredPackageWithMinimum.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.TieredPackageWithMinimum.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.TieredPackageWithMinimum.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .tieredPackageWithMinimumConfig(
                        Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.builder()
                            .packageSize(0.0)
                            .addTier(
                                Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.Tier
                                    .builder()
                                    .minimumAmount("minimum_amount")
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .addTier(
                                Price.TieredPackageWithMinimum.TieredPackageWithMinimumConfig.Tier
                                    .builder()
                                    .minimumAmount("minimum_amount")
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofPackageWithAllocation() {
        val packageWithAllocation =
            Price.PackageWithAllocation.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.PackageWithAllocation.BillingMode.IN_ADVANCE)
                .cadence(Price.PackageWithAllocation.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.PackageWithAllocation.CompositePriceFilter.builder()
                        .field(Price.PackageWithAllocation.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.PackageWithAllocation.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.PackageWithAllocation.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .packageWithAllocationConfig(
                    Price.PackageWithAllocation.PackageWithAllocationConfig.builder()
                        .allocation("allocation")
                        .packageAmount("package_amount")
                        .packageSize("package_size")
                        .build()
                )
                .planPhaseOrder(0L)
                .priceType(Price.PackageWithAllocation.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofPackageWithAllocation(packageWithAllocation)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isEqualTo(packageWithAllocation)
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofPackageWithAllocationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofPackageWithAllocation(
                Price.PackageWithAllocation.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.PackageWithAllocation.BillingMode.IN_ADVANCE)
                    .cadence(Price.PackageWithAllocation.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.PackageWithAllocation.CompositePriceFilter.builder()
                            .field(Price.PackageWithAllocation.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.PackageWithAllocation.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.PackageWithAllocation.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .packageWithAllocationConfig(
                        Price.PackageWithAllocation.PackageWithAllocationConfig.builder()
                            .allocation("allocation")
                            .packageAmount("package_amount")
                            .packageSize("package_size")
                            .build()
                    )
                    .planPhaseOrder(0L)
                    .priceType(Price.PackageWithAllocation.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofUnitWithPercent() {
        val unitWithPercent =
            Price.UnitWithPercent.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.UnitWithPercent.BillingMode.IN_ADVANCE)
                .cadence(Price.UnitWithPercent.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.UnitWithPercent.CompositePriceFilter.builder()
                        .field(Price.UnitWithPercent.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.UnitWithPercent.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.UnitWithPercent.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.UnitWithPercent.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .unitWithPercentConfig(
                    Price.UnitWithPercent.UnitWithPercentConfig.builder()
                        .percent("percent")
                        .unitAmount("unit_amount")
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofUnitWithPercent(unitWithPercent)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isEqualTo(unitWithPercent)
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofUnitWithPercentRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofUnitWithPercent(
                Price.UnitWithPercent.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.UnitWithPercent.BillingMode.IN_ADVANCE)
                    .cadence(Price.UnitWithPercent.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.UnitWithPercent.CompositePriceFilter.builder()
                            .field(Price.UnitWithPercent.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.UnitWithPercent.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.UnitWithPercent.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.UnitWithPercent.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .unitWithPercentConfig(
                        Price.UnitWithPercent.UnitWithPercentConfig.builder()
                            .percent("percent")
                            .unitAmount("unit_amount")
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMatrixWithAllocation() {
        val matrixWithAllocation =
            Price.MatrixWithAllocation.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.MatrixWithAllocation.BillingMode.IN_ADVANCE)
                .cadence(Price.MatrixWithAllocation.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.MatrixWithAllocation.CompositePriceFilter.builder()
                        .field(Price.MatrixWithAllocation.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.MatrixWithAllocation.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .matrixWithAllocationConfig(
                    MatrixWithAllocationConfig.builder()
                        .allocation("allocation")
                        .defaultUnitAmount("default_unit_amount")
                        .addDimension("string")
                        .addMatrixValue(
                            MatrixWithAllocationConfig.MatrixValue.builder()
                                .addDimensionValue("string")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.MatrixWithAllocation.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.MatrixWithAllocation.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMatrixWithAllocation(matrixWithAllocation)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isEqualTo(matrixWithAllocation)
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMatrixWithAllocationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMatrixWithAllocation(
                Price.MatrixWithAllocation.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.MatrixWithAllocation.BillingMode.IN_ADVANCE)
                    .cadence(Price.MatrixWithAllocation.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.MatrixWithAllocation.CompositePriceFilter.builder()
                            .field(Price.MatrixWithAllocation.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.MatrixWithAllocation.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .matrixWithAllocationConfig(
                        MatrixWithAllocationConfig.builder()
                            .allocation("allocation")
                            .defaultUnitAmount("default_unit_amount")
                            .addDimension("string")
                            .addMatrixValue(
                                MatrixWithAllocationConfig.MatrixValue.builder()
                                    .addDimensionValue("string")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.MatrixWithAllocation.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.MatrixWithAllocation.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofTieredWithProration() {
        val tieredWithProration =
            Price.TieredWithProration.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.TieredWithProration.BillingMode.IN_ADVANCE)
                .cadence(Price.TieredWithProration.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.TieredWithProration.CompositePriceFilter.builder()
                        .field(Price.TieredWithProration.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.TieredWithProration.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.TieredWithProration.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.TieredWithProration.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .tieredWithProrationConfig(
                    Price.TieredWithProration.TieredWithProrationConfig.builder()
                        .addTier(
                            Price.TieredWithProration.TieredWithProrationConfig.Tier.builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofTieredWithProration(tieredWithProration)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isEqualTo(tieredWithProration)
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofTieredWithProrationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofTieredWithProration(
                Price.TieredWithProration.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.TieredWithProration.BillingMode.IN_ADVANCE)
                    .cadence(Price.TieredWithProration.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.TieredWithProration.CompositePriceFilter.builder()
                            .field(Price.TieredWithProration.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.TieredWithProration.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.TieredWithProration.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.TieredWithProration.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .tieredWithProrationConfig(
                        Price.TieredWithProration.TieredWithProrationConfig.builder()
                            .addTier(
                                Price.TieredWithProration.TieredWithProrationConfig.Tier.builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofUnitWithProration() {
        val unitWithProration =
            Price.UnitWithProration.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.UnitWithProration.BillingMode.IN_ADVANCE)
                .cadence(Price.UnitWithProration.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.UnitWithProration.CompositePriceFilter.builder()
                        .field(Price.UnitWithProration.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.UnitWithProration.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.UnitWithProration.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.UnitWithProration.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .unitWithProrationConfig(
                    Price.UnitWithProration.UnitWithProrationConfig.builder()
                        .unitAmount("unit_amount")
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofUnitWithProration(unitWithProration)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isEqualTo(unitWithProration)
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofUnitWithProrationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofUnitWithProration(
                Price.UnitWithProration.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.UnitWithProration.BillingMode.IN_ADVANCE)
                    .cadence(Price.UnitWithProration.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.UnitWithProration.CompositePriceFilter.builder()
                            .field(Price.UnitWithProration.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.UnitWithProration.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.UnitWithProration.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.UnitWithProration.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .unitWithProrationConfig(
                        Price.UnitWithProration.UnitWithProrationConfig.builder()
                            .unitAmount("unit_amount")
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedAllocation() {
        val groupedAllocation =
            Price.GroupedAllocation.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedAllocation.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedAllocation.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedAllocation.CompositePriceFilter.builder()
                        .field(Price.GroupedAllocation.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.GroupedAllocation.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedAllocationConfig(
                    Price.GroupedAllocation.GroupedAllocationConfig.builder()
                        .allocation("allocation")
                        .groupingKey("x")
                        .overageUnitRate("overage_unit_rate")
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedAllocation.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedAllocation.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedAllocation(groupedAllocation)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isEqualTo(groupedAllocation)
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedAllocationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedAllocation(
                Price.GroupedAllocation.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedAllocation.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedAllocation.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedAllocation.CompositePriceFilter.builder()
                            .field(Price.GroupedAllocation.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.GroupedAllocation.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedAllocationConfig(
                        Price.GroupedAllocation.GroupedAllocationConfig.builder()
                            .allocation("allocation")
                            .groupingKey("x")
                            .overageUnitRate("overage_unit_rate")
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedAllocation.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedAllocation.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofBulkWithProration() {
        val bulkWithProration =
            Price.BulkWithProration.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.BulkWithProration.BillingMode.IN_ADVANCE)
                .bulkWithProrationConfig(
                    Price.BulkWithProration.BulkWithProrationConfig.builder()
                        .addTier(
                            Price.BulkWithProration.BulkWithProrationConfig.Tier.builder()
                                .unitAmount("unit_amount")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .addTier(
                            Price.BulkWithProration.BulkWithProrationConfig.Tier.builder()
                                .unitAmount("unit_amount")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .build()
                )
                .cadence(Price.BulkWithProration.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.BulkWithProration.CompositePriceFilter.builder()
                        .field(Price.BulkWithProration.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.BulkWithProration.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.BulkWithProration.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.BulkWithProration.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofBulkWithProration(bulkWithProration)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isEqualTo(bulkWithProration)
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofBulkWithProrationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofBulkWithProration(
                Price.BulkWithProration.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.BulkWithProration.BillingMode.IN_ADVANCE)
                    .bulkWithProrationConfig(
                        Price.BulkWithProration.BulkWithProrationConfig.builder()
                            .addTier(
                                Price.BulkWithProration.BulkWithProrationConfig.Tier.builder()
                                    .unitAmount("unit_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .addTier(
                                Price.BulkWithProration.BulkWithProrationConfig.Tier.builder()
                                    .unitAmount("unit_amount")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .build()
                    )
                    .cadence(Price.BulkWithProration.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.BulkWithProration.CompositePriceFilter.builder()
                            .field(Price.BulkWithProration.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.BulkWithProration.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.BulkWithProration.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.BulkWithProration.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedWithProratedMinimum() {
        val groupedWithProratedMinimum =
            Price.GroupedWithProratedMinimum.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedWithProratedMinimum.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedWithProratedMinimum.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedWithProratedMinimum.CompositePriceFilter.builder()
                        .field(Price.GroupedWithProratedMinimum.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.GroupedWithProratedMinimum.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedWithProratedMinimumConfig(
                    Price.GroupedWithProratedMinimum.GroupedWithProratedMinimumConfig.builder()
                        .groupingKey("x")
                        .minimum("minimum")
                        .unitRate("unit_rate")
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedWithProratedMinimum.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedWithProratedMinimum.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedWithProratedMinimum(groupedWithProratedMinimum)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isEqualTo(groupedWithProratedMinimum)
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedWithProratedMinimumRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedWithProratedMinimum(
                Price.GroupedWithProratedMinimum.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedWithProratedMinimum.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedWithProratedMinimum.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedWithProratedMinimum.CompositePriceFilter.builder()
                            .field(
                                Price.GroupedWithProratedMinimum.CompositePriceFilter.Field.PRICE_ID
                            )
                            .operator(
                                Price.GroupedWithProratedMinimum.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedWithProratedMinimumConfig(
                        Price.GroupedWithProratedMinimum.GroupedWithProratedMinimumConfig.builder()
                            .groupingKey("x")
                            .minimum("minimum")
                            .unitRate("unit_rate")
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedWithProratedMinimum.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedWithProratedMinimum.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedWithMeteredMinimum() {
        val groupedWithMeteredMinimum =
            Price.GroupedWithMeteredMinimum.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedWithMeteredMinimum.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedWithMeteredMinimum.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedWithMeteredMinimum.CompositePriceFilter.builder()
                        .field(Price.GroupedWithMeteredMinimum.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.GroupedWithMeteredMinimum.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedWithMeteredMinimumConfig(
                    Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig.builder()
                        .groupingKey("x")
                        .minimumUnitAmount("minimum_unit_amount")
                        .pricingKey("pricing_key")
                        .addScalingFactor(
                            Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig
                                .ScalingFactor
                                .builder()
                                .scalingFactor("scaling_factor")
                                .scalingValue("scaling_value")
                                .build()
                        )
                        .scalingKey("scaling_key")
                        .addUnitAmount(
                            Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig
                                .UnitAmount
                                .builder()
                                .pricingValue("pricing_value")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedWithMeteredMinimum.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedWithMeteredMinimum.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedWithMeteredMinimum(groupedWithMeteredMinimum)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isEqualTo(groupedWithMeteredMinimum)
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedWithMeteredMinimumRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedWithMeteredMinimum(
                Price.GroupedWithMeteredMinimum.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedWithMeteredMinimum.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedWithMeteredMinimum.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedWithMeteredMinimum.CompositePriceFilter.builder()
                            .field(
                                Price.GroupedWithMeteredMinimum.CompositePriceFilter.Field.PRICE_ID
                            )
                            .operator(
                                Price.GroupedWithMeteredMinimum.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedWithMeteredMinimumConfig(
                        Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig.builder()
                            .groupingKey("x")
                            .minimumUnitAmount("minimum_unit_amount")
                            .pricingKey("pricing_key")
                            .addScalingFactor(
                                Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig
                                    .ScalingFactor
                                    .builder()
                                    .scalingFactor("scaling_factor")
                                    .scalingValue("scaling_value")
                                    .build()
                            )
                            .scalingKey("scaling_key")
                            .addUnitAmount(
                                Price.GroupedWithMeteredMinimum.GroupedWithMeteredMinimumConfig
                                    .UnitAmount
                                    .builder()
                                    .pricingValue("pricing_value")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedWithMeteredMinimum.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedWithMeteredMinimum.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedWithMinMaxThresholds() {
        val groupedWithMinMaxThresholds =
            Price.GroupedWithMinMaxThresholds.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedWithMinMaxThresholds.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedWithMinMaxThresholds.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedWithMinMaxThresholds.CompositePriceFilter.builder()
                        .field(
                            Price.GroupedWithMinMaxThresholds.CompositePriceFilter.Field.PRICE_ID
                        )
                        .operator(
                            Price.GroupedWithMinMaxThresholds.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedWithMinMaxThresholdsConfig(
                    Price.GroupedWithMinMaxThresholds.GroupedWithMinMaxThresholdsConfig.builder()
                        .groupingKey("x")
                        .maximumCharge("maximum_charge")
                        .minimumCharge("minimum_charge")
                        .perUnitRate("per_unit_rate")
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedWithMinMaxThresholds.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedWithMinMaxThresholds.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedWithMinMaxThresholds(groupedWithMinMaxThresholds)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isEqualTo(groupedWithMinMaxThresholds)
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedWithMinMaxThresholdsRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedWithMinMaxThresholds(
                Price.GroupedWithMinMaxThresholds.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedWithMinMaxThresholds.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedWithMinMaxThresholds.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedWithMinMaxThresholds.CompositePriceFilter.builder()
                            .field(
                                Price.GroupedWithMinMaxThresholds.CompositePriceFilter.Field
                                    .PRICE_ID
                            )
                            .operator(
                                Price.GroupedWithMinMaxThresholds.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedWithMinMaxThresholdsConfig(
                        Price.GroupedWithMinMaxThresholds.GroupedWithMinMaxThresholdsConfig
                            .builder()
                            .groupingKey("x")
                            .maximumCharge("maximum_charge")
                            .minimumCharge("minimum_charge")
                            .perUnitRate("per_unit_rate")
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedWithMinMaxThresholds.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedWithMinMaxThresholds.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMatrixWithDisplayName() {
        val matrixWithDisplayName =
            Price.MatrixWithDisplayName.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.MatrixWithDisplayName.BillingMode.IN_ADVANCE)
                .cadence(Price.MatrixWithDisplayName.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.MatrixWithDisplayName.CompositePriceFilter.builder()
                        .field(Price.MatrixWithDisplayName.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.MatrixWithDisplayName.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .matrixWithDisplayNameConfig(
                    Price.MatrixWithDisplayName.MatrixWithDisplayNameConfig.builder()
                        .dimension("dimension")
                        .addUnitAmount(
                            Price.MatrixWithDisplayName.MatrixWithDisplayNameConfig.UnitAmount
                                .builder()
                                .dimensionValue("dimension_value")
                                .displayName("display_name")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.MatrixWithDisplayName.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.MatrixWithDisplayName.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMatrixWithDisplayName(matrixWithDisplayName)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isEqualTo(matrixWithDisplayName)
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMatrixWithDisplayNameRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMatrixWithDisplayName(
                Price.MatrixWithDisplayName.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.MatrixWithDisplayName.BillingMode.IN_ADVANCE)
                    .cadence(Price.MatrixWithDisplayName.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.MatrixWithDisplayName.CompositePriceFilter.builder()
                            .field(Price.MatrixWithDisplayName.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.MatrixWithDisplayName.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .matrixWithDisplayNameConfig(
                        Price.MatrixWithDisplayName.MatrixWithDisplayNameConfig.builder()
                            .dimension("dimension")
                            .addUnitAmount(
                                Price.MatrixWithDisplayName.MatrixWithDisplayNameConfig.UnitAmount
                                    .builder()
                                    .dimensionValue("dimension_value")
                                    .displayName("display_name")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.MatrixWithDisplayName.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.MatrixWithDisplayName.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofGroupedTieredPackage() {
        val groupedTieredPackage =
            Price.GroupedTieredPackage.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.GroupedTieredPackage.BillingMode.IN_ADVANCE)
                .cadence(Price.GroupedTieredPackage.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.GroupedTieredPackage.CompositePriceFilter.builder()
                        .field(Price.GroupedTieredPackage.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.GroupedTieredPackage.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .groupedTieredPackageConfig(
                    Price.GroupedTieredPackage.GroupedTieredPackageConfig.builder()
                        .groupingKey("x")
                        .packageSize("package_size")
                        .addTier(
                            Price.GroupedTieredPackage.GroupedTieredPackageConfig.Tier.builder()
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .addTier(
                            Price.GroupedTieredPackage.GroupedTieredPackageConfig.Tier.builder()
                                .perUnit("per_unit")
                                .tierLowerBound("tier_lower_bound")
                                .build()
                        )
                        .build()
                )
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.GroupedTieredPackage.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.GroupedTieredPackage.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofGroupedTieredPackage(groupedTieredPackage)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isEqualTo(groupedTieredPackage)
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofGroupedTieredPackageRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofGroupedTieredPackage(
                Price.GroupedTieredPackage.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.GroupedTieredPackage.BillingMode.IN_ADVANCE)
                    .cadence(Price.GroupedTieredPackage.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.GroupedTieredPackage.CompositePriceFilter.builder()
                            .field(Price.GroupedTieredPackage.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.GroupedTieredPackage.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .groupedTieredPackageConfig(
                        Price.GroupedTieredPackage.GroupedTieredPackageConfig.builder()
                            .groupingKey("x")
                            .packageSize("package_size")
                            .addTier(
                                Price.GroupedTieredPackage.GroupedTieredPackageConfig.Tier.builder()
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .addTier(
                                Price.GroupedTieredPackage.GroupedTieredPackageConfig.Tier.builder()
                                    .perUnit("per_unit")
                                    .tierLowerBound("tier_lower_bound")
                                    .build()
                            )
                            .build()
                    )
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.GroupedTieredPackage.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.GroupedTieredPackage.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMaxGroupTieredPackage() {
        val maxGroupTieredPackage =
            Price.MaxGroupTieredPackage.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.MaxGroupTieredPackage.BillingMode.IN_ADVANCE)
                .cadence(Price.MaxGroupTieredPackage.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.MaxGroupTieredPackage.CompositePriceFilter.builder()
                        .field(Price.MaxGroupTieredPackage.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.MaxGroupTieredPackage.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maxGroupTieredPackageConfig(
                    Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.builder()
                        .groupingKey("x")
                        .packageSize("package_size")
                        .addTier(
                            Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.Tier.builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .addTier(
                            Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.Tier.builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .build()
                )
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.MaxGroupTieredPackage.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.MaxGroupTieredPackage.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMaxGroupTieredPackage(maxGroupTieredPackage)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isEqualTo(maxGroupTieredPackage)
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMaxGroupTieredPackageRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMaxGroupTieredPackage(
                Price.MaxGroupTieredPackage.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.MaxGroupTieredPackage.BillingMode.IN_ADVANCE)
                    .cadence(Price.MaxGroupTieredPackage.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.MaxGroupTieredPackage.CompositePriceFilter.builder()
                            .field(Price.MaxGroupTieredPackage.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.MaxGroupTieredPackage.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maxGroupTieredPackageConfig(
                        Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.builder()
                            .groupingKey("x")
                            .packageSize("package_size")
                            .addTier(
                                Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.Tier
                                    .builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .addTier(
                                Price.MaxGroupTieredPackage.MaxGroupTieredPackageConfig.Tier
                                    .builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .build()
                    )
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.MaxGroupTieredPackage.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.MaxGroupTieredPackage.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofScalableMatrixWithUnitPricing() {
        val scalableMatrixWithUnitPricing =
            Price.ScalableMatrixWithUnitPricing.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.ScalableMatrixWithUnitPricing.BillingMode.IN_ADVANCE)
                .cadence(Price.ScalableMatrixWithUnitPricing.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.builder()
                        .field(
                            Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.Field.PRICE_ID
                        )
                        .operator(
                            Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.Operator
                                .INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.ScalableMatrixWithUnitPricing.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.ScalableMatrixWithUnitPricing.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .scalableMatrixWithUnitPricingConfig(
                    Price.ScalableMatrixWithUnitPricing.ScalableMatrixWithUnitPricingConfig
                        .builder()
                        .firstDimension("first_dimension")
                        .addMatrixScalingFactor(
                            Price.ScalableMatrixWithUnitPricing.ScalableMatrixWithUnitPricingConfig
                                .MatrixScalingFactor
                                .builder()
                                .firstDimensionValue("first_dimension_value")
                                .scalingFactor("scaling_factor")
                                .secondDimensionValue("second_dimension_value")
                                .build()
                        )
                        .unitPrice("unit_price")
                        .prorate(true)
                        .secondDimension("second_dimension")
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofScalableMatrixWithUnitPricing(scalableMatrixWithUnitPricing)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isEqualTo(scalableMatrixWithUnitPricing)
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofScalableMatrixWithUnitPricingRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofScalableMatrixWithUnitPricing(
                Price.ScalableMatrixWithUnitPricing.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.ScalableMatrixWithUnitPricing.BillingMode.IN_ADVANCE)
                    .cadence(Price.ScalableMatrixWithUnitPricing.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.builder()
                            .field(
                                Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.Field
                                    .PRICE_ID
                            )
                            .operator(
                                Price.ScalableMatrixWithUnitPricing.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.ScalableMatrixWithUnitPricing.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.ScalableMatrixWithUnitPricing.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .scalableMatrixWithUnitPricingConfig(
                        Price.ScalableMatrixWithUnitPricing.ScalableMatrixWithUnitPricingConfig
                            .builder()
                            .firstDimension("first_dimension")
                            .addMatrixScalingFactor(
                                Price.ScalableMatrixWithUnitPricing
                                    .ScalableMatrixWithUnitPricingConfig
                                    .MatrixScalingFactor
                                    .builder()
                                    .firstDimensionValue("first_dimension_value")
                                    .scalingFactor("scaling_factor")
                                    .secondDimensionValue("second_dimension_value")
                                    .build()
                            )
                            .unitPrice("unit_price")
                            .prorate(true)
                            .secondDimension("second_dimension")
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofScalableMatrixWithTieredPricing() {
        val scalableMatrixWithTieredPricing =
            Price.ScalableMatrixWithTieredPricing.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.ScalableMatrixWithTieredPricing.BillingMode.IN_ADVANCE)
                .cadence(Price.ScalableMatrixWithTieredPricing.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.builder()
                        .field(
                            Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.Field
                                .PRICE_ID
                        )
                        .operator(
                            Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.Operator
                                .INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.ScalableMatrixWithTieredPricing.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.ScalableMatrixWithTieredPricing.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .scalableMatrixWithTieredPricingConfig(
                    Price.ScalableMatrixWithTieredPricing.ScalableMatrixWithTieredPricingConfig
                        .builder()
                        .firstDimension("first_dimension")
                        .addMatrixScalingFactor(
                            Price.ScalableMatrixWithTieredPricing
                                .ScalableMatrixWithTieredPricingConfig
                                .MatrixScalingFactor
                                .builder()
                                .firstDimensionValue("first_dimension_value")
                                .scalingFactor("scaling_factor")
                                .secondDimensionValue("second_dimension_value")
                                .build()
                        )
                        .addTier(
                            Price.ScalableMatrixWithTieredPricing
                                .ScalableMatrixWithTieredPricingConfig
                                .Tier
                                .builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .addTier(
                            Price.ScalableMatrixWithTieredPricing
                                .ScalableMatrixWithTieredPricingConfig
                                .Tier
                                .builder()
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .secondDimension("second_dimension")
                        .build()
                )
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofScalableMatrixWithTieredPricing(scalableMatrixWithTieredPricing)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing())
            .isEqualTo(scalableMatrixWithTieredPricing)
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofScalableMatrixWithTieredPricingRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofScalableMatrixWithTieredPricing(
                Price.ScalableMatrixWithTieredPricing.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.ScalableMatrixWithTieredPricing.BillingMode.IN_ADVANCE)
                    .cadence(Price.ScalableMatrixWithTieredPricing.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.builder()
                            .field(
                                Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.Field
                                    .PRICE_ID
                            )
                            .operator(
                                Price.ScalableMatrixWithTieredPricing.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.ScalableMatrixWithTieredPricing.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.ScalableMatrixWithTieredPricing.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .scalableMatrixWithTieredPricingConfig(
                        Price.ScalableMatrixWithTieredPricing.ScalableMatrixWithTieredPricingConfig
                            .builder()
                            .firstDimension("first_dimension")
                            .addMatrixScalingFactor(
                                Price.ScalableMatrixWithTieredPricing
                                    .ScalableMatrixWithTieredPricingConfig
                                    .MatrixScalingFactor
                                    .builder()
                                    .firstDimensionValue("first_dimension_value")
                                    .scalingFactor("scaling_factor")
                                    .secondDimensionValue("second_dimension_value")
                                    .build()
                            )
                            .addTier(
                                Price.ScalableMatrixWithTieredPricing
                                    .ScalableMatrixWithTieredPricingConfig
                                    .Tier
                                    .builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .addTier(
                                Price.ScalableMatrixWithTieredPricing
                                    .ScalableMatrixWithTieredPricingConfig
                                    .Tier
                                    .builder()
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .secondDimension("second_dimension")
                            .build()
                    )
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofCumulativeGroupedBulk() {
        val cumulativeGroupedBulk =
            Price.CumulativeGroupedBulk.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.CumulativeGroupedBulk.BillingMode.IN_ADVANCE)
                .cadence(Price.CumulativeGroupedBulk.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.CumulativeGroupedBulk.CompositePriceFilter.builder()
                        .field(Price.CumulativeGroupedBulk.CompositePriceFilter.Field.PRICE_ID)
                        .operator(
                            Price.CumulativeGroupedBulk.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .cumulativeGroupedBulkConfig(
                    Price.CumulativeGroupedBulk.CumulativeGroupedBulkConfig.builder()
                        .addDimensionValue(
                            Price.CumulativeGroupedBulk.CumulativeGroupedBulkConfig.DimensionValue
                                .builder()
                                .groupingKey("x")
                                .tierLowerBound("tier_lower_bound")
                                .unitAmount("unit_amount")
                                .build()
                        )
                        .group("group")
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.CumulativeGroupedBulk.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.CumulativeGroupedBulk.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofCumulativeGroupedBulk(cumulativeGroupedBulk)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isEqualTo(cumulativeGroupedBulk)
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofCumulativeGroupedBulkRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofCumulativeGroupedBulk(
                Price.CumulativeGroupedBulk.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.CumulativeGroupedBulk.BillingMode.IN_ADVANCE)
                    .cadence(Price.CumulativeGroupedBulk.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.CumulativeGroupedBulk.CompositePriceFilter.builder()
                            .field(Price.CumulativeGroupedBulk.CompositePriceFilter.Field.PRICE_ID)
                            .operator(
                                Price.CumulativeGroupedBulk.CompositePriceFilter.Operator.INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .cumulativeGroupedBulkConfig(
                        Price.CumulativeGroupedBulk.CumulativeGroupedBulkConfig.builder()
                            .addDimensionValue(
                                Price.CumulativeGroupedBulk.CumulativeGroupedBulkConfig
                                    .DimensionValue
                                    .builder()
                                    .groupingKey("x")
                                    .tierLowerBound("tier_lower_bound")
                                    .unitAmount("unit_amount")
                                    .build()
                            )
                            .group("group")
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.CumulativeGroupedBulk.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.CumulativeGroupedBulk.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofCumulativeGroupedAllocation() {
        val cumulativeGroupedAllocation =
            Price.CumulativeGroupedAllocation.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.CumulativeGroupedAllocation.BillingMode.IN_ADVANCE)
                .cadence(Price.CumulativeGroupedAllocation.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.CumulativeGroupedAllocation.CompositePriceFilter.builder()
                        .field(
                            Price.CumulativeGroupedAllocation.CompositePriceFilter.Field.PRICE_ID
                        )
                        .operator(
                            Price.CumulativeGroupedAllocation.CompositePriceFilter.Operator.INCLUDES
                        )
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .cumulativeGroupedAllocationConfig(
                    Price.CumulativeGroupedAllocation.CumulativeGroupedAllocationConfig.builder()
                        .cumulativeAllocation("cumulative_allocation")
                        .groupAllocation("group_allocation")
                        .groupingKey("x")
                        .unitAmount("unit_amount")
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.CumulativeGroupedAllocation.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.CumulativeGroupedAllocation.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofCumulativeGroupedAllocation(cumulativeGroupedAllocation)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isEqualTo(cumulativeGroupedAllocation)
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofCumulativeGroupedAllocationRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofCumulativeGroupedAllocation(
                Price.CumulativeGroupedAllocation.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.CumulativeGroupedAllocation.BillingMode.IN_ADVANCE)
                    .cadence(Price.CumulativeGroupedAllocation.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.CumulativeGroupedAllocation.CompositePriceFilter.builder()
                            .field(
                                Price.CumulativeGroupedAllocation.CompositePriceFilter.Field
                                    .PRICE_ID
                            )
                            .operator(
                                Price.CumulativeGroupedAllocation.CompositePriceFilter.Operator
                                    .INCLUDES
                            )
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .cumulativeGroupedAllocationConfig(
                        Price.CumulativeGroupedAllocation.CumulativeGroupedAllocationConfig
                            .builder()
                            .cumulativeAllocation("cumulative_allocation")
                            .groupAllocation("group_allocation")
                            .groupingKey("x")
                            .unitAmount("unit_amount")
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.CumulativeGroupedAllocation.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.CumulativeGroupedAllocation.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMinimum() {
        val minimum =
            Price.Minimum.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Minimum.BillingMode.IN_ADVANCE)
                .cadence(Price.Minimum.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Minimum.CompositePriceFilter.builder()
                        .field(Price.Minimum.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Minimum.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Minimum.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .minimumConfig(
                    Price.Minimum.MinimumConfig.builder()
                        .minimumAmount("minimum_amount")
                        .prorated(true)
                        .build()
                )
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.Minimum.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMinimum(minimum)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isEqualTo(minimum)
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMinimumRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMinimum(
                Price.Minimum.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Minimum.BillingMode.IN_ADVANCE)
                    .cadence(Price.Minimum.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Minimum.CompositePriceFilter.builder()
                            .field(Price.Minimum.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Minimum.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Minimum.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .minimumConfig(
                        Price.Minimum.MinimumConfig.builder()
                            .minimumAmount("minimum_amount")
                            .prorated(true)
                            .build()
                    )
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.Minimum.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofMinimumComposite() {
        val minimumComposite =
            Price.MinimumComposite.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.MinimumComposite.BillingMode.IN_ADVANCE)
                .cadence(Price.MinimumComposite.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.MinimumComposite.CompositePriceFilter.builder()
                        .field(Price.MinimumComposite.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.MinimumComposite.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.MinimumComposite.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .minimumCompositeConfig(
                    Price.MinimumComposite.MinimumCompositeConfig.builder()
                        .minimumAmount("minimum_amount")
                        .prorated(true)
                        .build()
                )
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.MinimumComposite.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofMinimumComposite(minimumComposite)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isEqualTo(minimumComposite)
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofMinimumCompositeRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofMinimumComposite(
                Price.MinimumComposite.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.MinimumComposite.BillingMode.IN_ADVANCE)
                    .cadence(Price.MinimumComposite.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.MinimumComposite.CompositePriceFilter.builder()
                            .field(Price.MinimumComposite.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.MinimumComposite.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.MinimumComposite.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .minimumCompositeConfig(
                        Price.MinimumComposite.MinimumCompositeConfig.builder()
                            .minimumAmount("minimum_amount")
                            .prorated(true)
                            .build()
                    )
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.MinimumComposite.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofPercent() {
        val percent =
            Price.Percent.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.Percent.BillingMode.IN_ADVANCE)
                .cadence(Price.Percent.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.Percent.CompositePriceFilter.builder()
                        .field(Price.Percent.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.Percent.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.Percent.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .percentConfig(Price.Percent.PercentConfig.builder().percent(0.0).build())
                .planPhaseOrder(0L)
                .priceType(Price.Percent.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofPercent(percent)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isEqualTo(percent)
        assertThat(price.eventOutput()).isNull()
    }

    @Test
    fun ofPercentRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofPercent(
                Price.Percent.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.Percent.BillingMode.IN_ADVANCE)
                    .cadence(Price.Percent.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.Percent.CompositePriceFilter.builder()
                            .field(Price.Percent.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.Percent.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.Percent.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .percentConfig(Price.Percent.PercentConfig.builder().percent(0.0).build())
                    .planPhaseOrder(0L)
                    .priceType(Price.Percent.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    @Test
    fun ofEventOutput() {
        val eventOutput =
            Price.EventOutput.builder()
                .id("id")
                .billableMetric(BillableMetricTiny.builder().id("id").build())
                .billingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .billingMode(Price.EventOutput.BillingMode.IN_ADVANCE)
                .cadence(Price.EventOutput.Cadence.ONE_TIME)
                .addCompositePriceFilter(
                    Price.EventOutput.CompositePriceFilter.builder()
                        .field(Price.EventOutput.CompositePriceFilter.Field.PRICE_ID)
                        .operator(Price.EventOutput.CompositePriceFilter.Operator.INCLUDES)
                        .addValue("string")
                        .build()
                )
                .conversionRate(0.0)
                .unitConversionRateConfig(
                    ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                )
                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditAllocation(
                    Allocation.builder()
                        .allowsRollover(true)
                        .currency("currency")
                        .customExpiration(
                            CustomExpiration.builder()
                                .duration(0L)
                                .durationUnit(CustomExpiration.DurationUnit.DAY)
                                .build()
                        )
                        .addFilter(
                            Allocation.Filter.builder()
                                .field(Allocation.Filter.Field.PRICE_ID)
                                .operator(Allocation.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .build()
                )
                .currency("currency")
                .discount(
                    PercentageDiscount.builder()
                        .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                        .percentageDiscount(0.15)
                        .addAppliesToPriceId("h74gfhdjvn7ujokd")
                        .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                        .addFilter(
                            PercentageDiscount.Filter.builder()
                                .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .reason("reason")
                        .build()
                )
                .eventOutputConfig(
                    Price.EventOutput.EventOutputConfig.builder()
                        .unitRatingKey("x")
                        .defaultUnitRate("default_unit_rate")
                        .groupingKey("grouping_key")
                        .build()
                )
                .externalPriceId("external_price_id")
                .fixedPriceQuantity(0.0)
                .invoicingCycleConfiguration(
                    BillingCycleConfiguration.builder()
                        .duration(0L)
                        .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                        .build()
                )
                .item(ItemSlim.builder().id("id").name("name").build())
                .maximum(
                    Maximum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Maximum.Filter.builder()
                                .field(Maximum.Filter.Field.PRICE_ID)
                                .operator(Maximum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .maximumAmount("maximum_amount")
                        .build()
                )
                .maximumAmount("maximum_amount")
                .metadata(
                    Price.EventOutput.Metadata.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .minimum(
                    Minimum.builder()
                        .addAppliesToPriceId("string")
                        .addFilter(
                            Minimum.Filter.builder()
                                .field(Minimum.Filter.Field.PRICE_ID)
                                .operator(Minimum.Filter.Operator.INCLUDES)
                                .addValue("string")
                                .build()
                        )
                        .minimumAmount("minimum_amount")
                        .build()
                )
                .minimumAmount("minimum_amount")
                .name("name")
                .planPhaseOrder(0L)
                .priceType(Price.EventOutput.PriceType.USAGE_PRICE)
                .replacesPriceId("replaces_price_id")
                .dimensionalPriceConfiguration(
                    DimensionalPriceConfiguration.builder()
                        .addDimensionValue("string")
                        .dimensionalPriceGroupId("dimensional_price_group_id")
                        .build()
                )
                .build()

        val price = Price.ofEventOutput(eventOutput)

        assertThat(price.unit()).isNull()
        assertThat(price.tiered()).isNull()
        assertThat(price.bulk()).isNull()
        assertThat(price.bulkWithFilters()).isNull()
        assertThat(price.package_()).isNull()
        assertThat(price.matrix()).isNull()
        assertThat(price.thresholdTotalAmount()).isNull()
        assertThat(price.tieredPackage()).isNull()
        assertThat(price.tieredWithMinimum()).isNull()
        assertThat(price.groupedTiered()).isNull()
        assertThat(price.tieredPackageWithMinimum()).isNull()
        assertThat(price.packageWithAllocation()).isNull()
        assertThat(price.unitWithPercent()).isNull()
        assertThat(price.matrixWithAllocation()).isNull()
        assertThat(price.tieredWithProration()).isNull()
        assertThat(price.unitWithProration()).isNull()
        assertThat(price.groupedAllocation()).isNull()
        assertThat(price.bulkWithProration()).isNull()
        assertThat(price.groupedWithProratedMinimum()).isNull()
        assertThat(price.groupedWithMeteredMinimum()).isNull()
        assertThat(price.groupedWithMinMaxThresholds()).isNull()
        assertThat(price.matrixWithDisplayName()).isNull()
        assertThat(price.groupedTieredPackage()).isNull()
        assertThat(price.maxGroupTieredPackage()).isNull()
        assertThat(price.scalableMatrixWithUnitPricing()).isNull()
        assertThat(price.scalableMatrixWithTieredPricing()).isNull()
        assertThat(price.cumulativeGroupedBulk()).isNull()
        assertThat(price.cumulativeGroupedAllocation()).isNull()
        assertThat(price.minimum()).isNull()
        assertThat(price.minimumComposite()).isNull()
        assertThat(price.percent()).isNull()
        assertThat(price.eventOutput()).isEqualTo(eventOutput)
    }

    @Test
    fun ofEventOutputRoundtrip() {
        val jsonMapper = jsonMapper()
        val price =
            Price.ofEventOutput(
                Price.EventOutput.builder()
                    .id("id")
                    .billableMetric(BillableMetricTiny.builder().id("id").build())
                    .billingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .billingMode(Price.EventOutput.BillingMode.IN_ADVANCE)
                    .cadence(Price.EventOutput.Cadence.ONE_TIME)
                    .addCompositePriceFilter(
                        Price.EventOutput.CompositePriceFilter.builder()
                            .field(Price.EventOutput.CompositePriceFilter.Field.PRICE_ID)
                            .operator(Price.EventOutput.CompositePriceFilter.Operator.INCLUDES)
                            .addValue("string")
                            .build()
                    )
                    .conversionRate(0.0)
                    .unitConversionRateConfig(
                        ConversionRateUnitConfig.builder().unitAmount("unit_amount").build()
                    )
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditAllocation(
                        Allocation.builder()
                            .allowsRollover(true)
                            .currency("currency")
                            .customExpiration(
                                CustomExpiration.builder()
                                    .duration(0L)
                                    .durationUnit(CustomExpiration.DurationUnit.DAY)
                                    .build()
                            )
                            .addFilter(
                                Allocation.Filter.builder()
                                    .field(Allocation.Filter.Field.PRICE_ID)
                                    .operator(Allocation.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .build()
                    )
                    .currency("currency")
                    .discount(
                        PercentageDiscount.builder()
                            .discountType(PercentageDiscount.DiscountType.PERCENTAGE)
                            .percentageDiscount(0.15)
                            .addAppliesToPriceId("h74gfhdjvn7ujokd")
                            .addAppliesToPriceId("7hfgtgjnbvc3ujkl")
                            .addFilter(
                                PercentageDiscount.Filter.builder()
                                    .field(PercentageDiscount.Filter.Field.PRICE_ID)
                                    .operator(PercentageDiscount.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .reason("reason")
                            .build()
                    )
                    .eventOutputConfig(
                        Price.EventOutput.EventOutputConfig.builder()
                            .unitRatingKey("x")
                            .defaultUnitRate("default_unit_rate")
                            .groupingKey("grouping_key")
                            .build()
                    )
                    .externalPriceId("external_price_id")
                    .fixedPriceQuantity(0.0)
                    .invoicingCycleConfiguration(
                        BillingCycleConfiguration.builder()
                            .duration(0L)
                            .durationUnit(BillingCycleConfiguration.DurationUnit.DAY)
                            .build()
                    )
                    .item(ItemSlim.builder().id("id").name("name").build())
                    .maximum(
                        Maximum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Maximum.Filter.builder()
                                    .field(Maximum.Filter.Field.PRICE_ID)
                                    .operator(Maximum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .maximumAmount("maximum_amount")
                            .build()
                    )
                    .maximumAmount("maximum_amount")
                    .metadata(
                        Price.EventOutput.Metadata.builder()
                            .putAdditionalProperty("foo", JsonValue.from("string"))
                            .build()
                    )
                    .minimum(
                        Minimum.builder()
                            .addAppliesToPriceId("string")
                            .addFilter(
                                Minimum.Filter.builder()
                                    .field(Minimum.Filter.Field.PRICE_ID)
                                    .operator(Minimum.Filter.Operator.INCLUDES)
                                    .addValue("string")
                                    .build()
                            )
                            .minimumAmount("minimum_amount")
                            .build()
                    )
                    .minimumAmount("minimum_amount")
                    .name("name")
                    .planPhaseOrder(0L)
                    .priceType(Price.EventOutput.PriceType.USAGE_PRICE)
                    .replacesPriceId("replaces_price_id")
                    .dimensionalPriceConfiguration(
                        DimensionalPriceConfiguration.builder()
                            .addDimensionValue("string")
                            .dimensionalPriceGroupId("dimensional_price_group_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedPrice =
            jsonMapper.readValue(jsonMapper.writeValueAsString(price), jacksonTypeRef<Price>())

        assertThat(roundtrippedPrice).isEqualTo(price)
    }

    enum class IncompatibleJsonShapeTestCase(val value: JsonValue) {
        BOOLEAN(JsonValue.from(false)),
        STRING(JsonValue.from("invalid")),
        INTEGER(JsonValue.from(-1)),
        FLOAT(JsonValue.from(3.14)),
        ARRAY(JsonValue.from(listOf("invalid", "array"))),
    }

    @ParameterizedTest
    @EnumSource
    fun incompatibleJsonShapeDeserializesToUnknown(testCase: IncompatibleJsonShapeTestCase) {
        val price = jsonMapper().convertValue(testCase.value, jacksonTypeRef<Price>())

        val e = assertThrows<OrbInvalidDataException> { price.validate() }
        assertThat(e).hasMessageStartingWith("Unknown ")
    }
}
